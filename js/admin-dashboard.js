(function(t){window.addEventListener("load",function(){C(),b()}),t(function(){t(".pvc-accordion-header").on("click",function(o){t(this).closest(".pvc-accordion-item").toggleClass("pvc-collapsed");const e=t("#pvc-dashboard-accordion").find(".pvc-accordion-item"),i={};e.length>0&&t(e).each(function(n,d){let a=t(d).attr("id");a=a.replace("pvc-",""),i[a]=t(d).hasClass("pvc-collapsed")}),pvcUpdateUserOptions({menu_items:i})})});const u=t({});t.pvcAjaxQueue=function(o){let e;const i=t.Deferred(),n=i.promise();function d(a){e=t.ajax(o),e.done(i.resolve).fail(i.reject).then(a,a)}return u.queue(d),n.abort=function(a){if(e)return e.abort(a);const s=u.queue(),r=t.inArray(d,s);return r>-1&&s.splice(r,1),i.rejectWith(o.context||o,[n,a,""]),n},n},pvcUpdateUserOptions=function(o){t.pvcAjaxQueue({url:pvcArgs.ajaxURL,type:"POST",dataType:"json",data:{action:"pvc_dashboard_user_options",nonce:pvcArgs.nonceUser,options:o},success:function(){}})},pvcUpdateConfig=function(o,e){return o.data=e.data,o.options.plugins.tooltip={callbacks:{title:function(i){return e.data.dates[i[0].dataIndex]}}},t.each(o.data.datasets,function(i,n){n.fill=e.design.fill,n.tension=.4,n.borderColor=e.design.borderColor,n.backgroundColor=e.design.backgroundColor,n.borderWidth=e.design.borderWidth,n.borderDash=e.design.borderDash,n.pointBorderColor=e.design.pointBorderColor,n.pointBackgroundColor=e.design.pointBackgroundColor,n.pointBorderWidth=e.design.pointBorderWidth}),o};function f(o,e,i){t(i).addClass("loading").find(".spinner").addClass("is-active"),t.ajax({url:pvcArgs.ajaxURL,type:"POST",dataType:"json",data:{action:"pvc_dashboard_post_most_viewed",nonce:pvcArgs.nonce,period:e},success:function(n){t(i).removeClass("loading"),t(i).find(".spinner").removeClass("is-active"),o||c(n.dates,i),t(i).find("#pvc-post-most-viewed-content").html(n.html),w("pvc-dashboard-widget-loaded",n)}})}function g(o,e,i){t(i).addClass("loading").find(".spinner").addClass("is-active"),t.ajax({url:pvcArgs.ajaxURL,type:"POST",dataType:"json",data:{action:"pvc_dashboard_post_views_chart",nonce:pvcArgs.nonce,period:e,lang:pvcArgs.lang?pvcArgs.lang:""},success:function(n){if(t(i).removeClass("loading"),t(i).find(".spinner").removeClass("is-active"),o){let d={type:"line",options:{maintainAspectRatio:!1,responsive:!0,plugins:{legend:{display:!0,position:"bottom",align:"center",fullSize:!0,onHover:function(a){a.native.target.style.cursor="pointer"},onLeave:function(a){a.native.target.style.cursor="default"},onClick:function(a,s,r){const l=s.datasetIndex,p=r.chart,v=p.getDatasetMeta(l);p.isDatasetVisible(l)?v.hidden=!0:v.hidden=!1,p.update(),pvcUpdateUserOptions({post_type:p.data.datasets[l].post_type,hidden:v.hidden})},labels:{boxWidth:8,boxHeight:8,font:{size:13,weight:"normal",family:"'-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', 'sans-serif'"},padding:10,usePointStyle:!1,textAlign:"center"}}},scales:{x:{display:!0,title:{display:!1}},y:{display:!0,grace:0,beginAtZero:!0,title:{display:!1},ticks:{precision:0,maxTicksLimit:12}}},hover:{mode:"label"}}};d=pvcUpdateConfig(d,n),window.postViewsChart=new Chart(document.getElementById("pvc-post-views-chart").getContext("2d"),d)}else c(n.dates,i),window.postViewsChart.config=pvcUpdateConfig(window.postViewsChart.config,n),window.postViewsChart.update();w("pvc-dashboard-widget-loaded",n)}})}function C(o=""){const e=t("#pvc-post-views").find(".pvc-dashboard-container");t(e).length>0&&(c(!1,e),g(!0,o,e))}function b(o=""){const e=t("#pvc-post-most-viewed").find(".pvc-dashboard-container");t(e).length>0&&(c(!1,e),f(!0,o,e))}function c(o,e){const i=t(e).find(".pvc-date-nav");o!==!1&&(i[0].innerHTML=o);const n=i[0].getElementsByClassName("prev")[0],d=i[0].getElementsByClassName("next")[0],a=t(e).closest(".pvc-accordion-item").attr("id");a==="pvc-post-most-viewed"?n.addEventListener("click",function(s){s.preventDefault(),m(s.target.dataset.date)}):a==="pvc-post-views"&&n.addEventListener("click",function(s){s.preventDefault(),h(s.target.dataset.date)}),d.tagName==="A"&&(a==="pvc-post-most-viewed"?d.addEventListener("click",function(s){s.preventDefault(),m(s.target.dataset.date)}):a==="pvc-post-views"&&d.addEventListener("click",function(s){s.preventDefault(),h(s.target.dataset.date)}))}function h(o=""){const e=t("#pvc-post-views").find(".pvc-dashboard-container");g(!1,o,e)}function m(o=""){const e=t("#pvc-post-most-viewed").find(".pvc-dashboard-container");f(!1,o,e)}function w(o,e){["dates","html","design"].forEach(function(d){delete e[d]});const n=new CustomEvent(o,{detail:e});window.dispatchEvent(n)}})(jQuery);
